(self.webpackChunk=self.webpackChunk||[]).push([[7953,578],{81043:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="ClockCircleOutlined";var c=l.forwardRef(r)},39449:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="DeleteOutlined";var c=l.forwardRef(r)},67020:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="FileTextOutlined";var c=l.forwardRef(r)},7651:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="Loading3QuartersOutlined";var c=l.forwardRef(r)},97260:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="PauseCircleOutlined";var c=l.forwardRef(r)},9594:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="PlayCircleOutlined";var c=l.forwardRef(r)},2679:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var i=e(22405),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},m=f,S=e(17980),r=function(h,j){return l.createElement(S.Z,(0,i.Z)((0,i.Z)({},h),{},{ref:j,icon:m}))};r.displayName="StopOutlined";var c=l.forwardRef(r)},24984:function(p,C,e){"use strict";e.r(C),e.d(C,{IntervalSchedule:function(){return G},SubscriptionStatus:function(){return F},SubscriptionType:function(){return X},default:function(){return le}});var i=e(94434),l=e.n(i),f=e(46686),m=e.n(f),S=e(30279),r=e.n(S),c=e(63313),v=e(95581),h=e(62021),j=e(37907),he=e(95326),x=e(79697),L=e(4675),_=e(15976),De=e(89724),ee=e(67265),Z=e(45073),xe=e(39769),ae=e(81043),se=e(7651),P=e(31004),t=e(9594),b=e(97260),o=e(67020),y=e(26099),ue=e(96320),te=e(2679),W=e(39449),B=e(94764),I=e(19452),k=e(77763),H=e(28608),Y=e(89634),M=e(63787),Q=e(72440),ne=e(42642),u=e(11527),J=v.Z.Text,ce=v.Z.Paragraph,de=h.Z.Search,F;(function(d){d[d.running=0]="running",d[d.idle=1]="idle",d[d.disabled=2]="disabled",d[d.queued=3]="queued"})(F||(F={}));var G;(function(d){d.days="\u5929",d.hours="\u65F6",d.minutes="\u5206",d.seconds="\u79D2"})(G||(G={}));var X;(function(d){d["private-repo"]="\u79C1\u6709\u4ED3\u5E93",d["public-repo"]="\u516C\u5F00\u4ED3\u5E93",d.file="\u5355\u6587\u4EF6"})(X||(X={}));var me=function(){var Ee=(0,Q.bx)(),Oe=Ee.headerStyle,Pe=Ee.isPhone,re=Ee.socketMessage,je=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:150,align:"center",sorter:{compare:function(n,a){return n.name.localeCompare(a.name)},multiple:2}},{title:"\u94FE\u63A5",dataIndex:"url",key:"url",align:"center",sorter:{compare:function(n,a){return n.name.localeCompare(a.name)},multiple:2},render:function(n,a){return(0,u.jsx)(ce,{style:{wordBreak:"break-all",marginBottom:0,textAlign:"left"},ellipsis:{tooltip:n,rows:2},children:n})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:130,align:"center",render:function(n,a){return X[a.type]}},{title:"\u5206\u652F",dataIndex:"branch",key:"branch",width:130,align:"center",render:function(n,a){return a.branch||"-"}},{title:"\u5B9A\u65F6\u89C4\u5219",width:180,align:"center",render:function(n,a){if(a.schedule_type==="interval"){var g=a.interval_schedule,A=g.type,T=g.value;return"\u6BCF".concat(T).concat(G[A])}return a.schedule}},{title:"\u72B6\u6001",key:"status",dataIndex:"status",align:"center",width:110,filters:[{text:"\u8FD0\u884C\u4E2D",value:0},{text:"\u7A7A\u95F2\u4E2D",value:1},{text:"\u5DF2\u7981\u7528",value:2}],onFilter:function(n,a){return a.is_disabled&&a.status!==0?n===2:a.status===n},render:function(n,a){return(0,u.jsxs)(u.Fragment,{children:[(!a.is_disabled||a.status!==F.idle)&&(0,u.jsxs)(u.Fragment,{children:[a.status===F.idle&&(0,u.jsx)(j.Z,{icon:(0,u.jsx)(ae.Z,{}),color:"default",children:"\u7A7A\u95F2\u4E2D"}),a.status===F.running&&(0,u.jsx)(j.Z,{icon:(0,u.jsx)(se.Z,{spin:!0}),color:"processing",children:"\u8FD0\u884C\u4E2D"})]}),a.is_disabled===1&&a.status===F.idle&&(0,u.jsx)(j.Z,{icon:(0,u.jsx)(P.Z,{}),color:"error",children:"\u5DF2\u7981\u7528"})]})}},{title:"\u64CD\u4F5C",key:"action",align:"center",width:130,render:function(n,a,g){var A=!Pe;return(0,u.jsxs)(he.Z,{size:"middle",children:[a.status===F.idle&&(0,u.jsx)(x.Z,{title:A?"\u8FD0\u884C":"",children:(0,u.jsx)("a",{onClick:function(q){q.stopPropagation(),et(a,g)},children:(0,u.jsx)(t.Z,{})})}),a.status!==F.idle&&(0,u.jsx)(x.Z,{title:A?"\u505C\u6B62":"",children:(0,u.jsx)("a",{onClick:function(q){q.stopPropagation(),tt(a,g)},children:(0,u.jsx)(b.Z,{})})}),(0,u.jsx)(x.Z,{title:A?"\u65E5\u5FD7":"",children:(0,u.jsx)("a",{onClick:function(q){q.stopPropagation(),qe(r()(r()({},a),{},{timestamp:Date.now()}))},children:(0,u.jsx)(o.Z,{})})}),(0,u.jsx)(it,{record:a,index:g},"more")]})}}],be=(0,c.useState)([]),Se=m()(be,2),w=Se[0],$=Se[1],pe=(0,c.useState)(!0),Fe=m()(pe,2),Ae=Fe[0],Ze=Fe[1],Me=(0,c.useState)(!1),_e=m()(Me,2),R=_e[0],s=_e[1],D=(0,c.useState)(),E=m()(D,2),K=E[0],N=E[1],ve=(0,c.useState)(""),ie=m()(ve,2),ye=ie[0],z=ie[1],Ce=(0,c.useState)(1),ge=m()(Ce,2),Be=ge[0],Te=ge[1],Re=(0,c.useState)(20),fe=m()(Re,2),Ve=fe[0],Le=fe[1],ke=(0,c.useState)(),We=m()(ke,2),He=We[0],we=We[1],Qe=(0,c.useState)(""),ze=m()(Qe,2),Ge=ze[0],$e=ze[1],Ye=(0,c.useState)(!1),Ue=m()(Ye,2),Je=Ue[0],Ke=Ue[1],Xe=(0,c.useState)(),Ne=m()(Xe,2),Ie=Ne[0],qe=Ne[1],et=function(n,a){L.Z.confirm({title:"\u786E\u8BA4\u8FD0\u884C",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1"," ",(0,u.jsx)(J,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(I.Z.apiPrefix,"subscriptions/run"),{data:[n.id]}).then(function(A){var T=A.code,q=A.data;if(T===200){var U=l()(w),V=U.findIndex(function(oe){return oe.id===n.id});V!==-1&&(U.splice(V,1,r()(r()({},n),{},{status:F.running})),$(U))}})},onCancel:function(){console.log("Cancel")}})},tt=function(n,a){L.Z.confirm({title:"\u786E\u8BA4\u505C\u6B62",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u505C\u6B62\u5B9A\u65F6\u4EFB\u52A1"," ",(0,u.jsx)(J,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(I.Z.apiPrefix,"subscriptions/stop"),{data:[n.id]}).then(function(A){var T=A.code,q=A.data;if(T===200){var U=l()(w),V=U.findIndex(function(oe){return oe.id===n.id});V!==-1&&(U.splice(V,1,r()(r()({},n),{},{pid:null,status:F.idle})),$(U))}})},onCancel:function(){console.log("Cancel")}})},nt=function(){Ze(!0),H.W.get("".concat(I.Z.apiPrefix,"subscriptions?searchValue=").concat(ye)).then(function(n){var a=n.code,g=n.data;a===200&&($(g),Te(1))}).finally(function(){return Ze(!1)})},at=function(){N(null),s(!0)},ut=function(n,a){N(n),s(!0)},lt=function(n,a){L.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u8BA2\u9605"," ",(0,u.jsx)(J,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.delete("".concat(I.Z.apiPrefix,"subscriptions"),{data:[n.id]}).then(function(A){var T=A.code,q=A.data;if(T===200){_.ZP.success("\u5220\u9664\u6210\u529F");var U=l()(w),V=U.findIndex(function(oe){return oe.id===n.id});V!==-1&&(U.splice(V,1),$(U))}})},onCancel:function(){console.log("Cancel")}})},rt=function(n,a){L.Z.confirm({title:"\u786E\u8BA4".concat(n.is_disabled===1?"\u542F\u7528":"\u7981\u7528"),content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4",n.is_disabled===1?"\u542F\u7528":"\u7981\u7528","\u5B9A\u65F6\u8BA2\u9605"," ",(0,u.jsx)(J,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(I.Z.apiPrefix,"subscriptions/").concat(n.is_disabled===1?"enable":"disable"),{data:[n.id]}).then(function(A){var T=A.code,q=A.data;if(T===200){var U=n.is_disabled===1?0:1,V=l()(w),oe=V.findIndex(function(ht){return ht.id===n.id});oe!==-1&&(V.splice(oe,1,r()(r()({},n),{},{is_disabled:U})),$(V))}})},onCancel:function(){console.log("Cancel")}})},it=function(n){var a=n.record,g=n.index;return(0,u.jsx)(De.Z,{arrow:{pointAtCenter:!0},placement:"bottomRight",trigger:["click"],overlay:(0,u.jsx)(ee.Z,{items:[{label:"\u7F16\u8F91",key:"edit",icon:(0,u.jsx)(y.Z,{})},{label:a.is_disabled===1?"\u542F\u7528":"\u7981\u7528",key:"enableOrDisable",icon:a.is_disabled===1?(0,u.jsx)(ue.Z,{}):(0,u.jsx)(te.Z,{})},{label:"\u5220\u9664",key:"delete",icon:(0,u.jsx)(W.Z,{})}],onClick:function(T){var q=T.key,U=T.domEvent;U.stopPropagation(),ot(q,a,g)}}),children:(0,u.jsx)("a",{onClick:function(T){return T.stopPropagation()},children:(0,u.jsx)(B.Z,{})})})},ot=function(n,a,g){switch(n){case"edit":ut(a,g);break;case"enableOrDisable":rt(a,g);break;case"delete":lt(a,g);break;default:break}},st=function(n){s(!1),n&&dt(n)},ct=function(n){z(n.trim())},dt=function(n){var a=w.findIndex(function(A){return A.id===n.id}),g=l()(w);a===-1?g.unshift(n):g.splice(a,1,r()({},n)),$(g)},vt=function(n,a){Te(n),Le(a),localStorage.setItem("pageSize",a+"")},ft=function(n,a){return n.isPinned?"pinned-subscription subscription":"subscription"};return(0,c.useEffect)(function(){if(!!re){var O=re.type,n=re.message,a=re.references;if(O==="runSubscriptionEnd"&&a.length>0){for(var g=l()(w),A=function(U){var V=w.findIndex(function(oe){return oe.id===a[U]});V!==-1&&g.splice(V,1,r()(r()({},w[V]),{},{status:F.idle}))},T=0;T<a.length;T++)A(T);$(g)}}},[re]),(0,c.useEffect)(function(){Ie&&(localStorage.setItem("logSubscription",Ie.id),Ke(!0))},[Ie]),(0,c.useEffect)(function(){nt()},[ye]),(0,c.useEffect)(function(){Le(parseInt(localStorage.getItem("pageSize")||"20")),setTimeout(function(){we((0,M.W9)())})},[]),(0,u.jsxs)(k.ZP,{className:"ql-container-wrapper subscriptiontab-wrapper",title:"\u8BA2\u9605\u7BA1\u7406",extra:[(0,u.jsx)(de,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u8005\u5173\u952E\u8BCD",style:{width:"auto"},enterButton:!0,allowClear:!0,loading:Ae,value:Ge,onChange:function(n){return $e(n.target.value)},onSearch:ct}),(0,u.jsx)(Z.Z,{type:"primary",onClick:function(){return at()},children:"\u65B0\u5EFA\u8BA2\u9605"},"2")],header:{style:Oe},children:[(0,u.jsx)(xe.Z,{columns:je,pagination:{current:Be,onChange:vt,pageSize:Ve,showSizeChanger:!0,simple:Pe,defaultPageSize:20,showTotal:function(n,a){return"\u7B2C ".concat(a[0],"-").concat(a[1]," \u6761/\u603B\u5171 ").concat(n," \u6761")},pageSizeOptions:[20,100,500,1e3]},dataSource:w,rowKey:"id",size:"middle",scroll:{x:1e3,y:He},loading:Ae,rowClassName:ft}),(0,u.jsx)(Y.default,{visible:R,handleCancel:st,subscription:K}),(0,u.jsx)(ne.default,{visible:Je,handleCancel:function(){Ke(!1)},subscription:Ie})]})},le=me},42642:function(p,C,e){"use strict";e.r(C);var i=e(46686),l=e.n(i),f=e(63313),m=e.n(f),S=e(4675),r=e(45073),c=e(28608),v=e(19452),h=e(7651),j=e(96320),he=e(76857),x=e(63787),L=e(11527),_=function(ee){var Z=ee.subscription,xe=ee.handleCancel,ae=ee.visible,se=ee.data,P=ee.logUrl,t=(0,f.useState)("\u542F\u52A8\u4E2D..."),b=l()(t,2),o=b[0],y=b[1],ue=(0,f.useState)(!0),te=l()(ue,2),W=te[0],B=te[1],I=(0,f.useState)(!0),k=l()(I,2),H=k[0],Y=k[1],M=(0,f.useState)(!1),Q=l()(M,2),ne=Q[0],u=Q[1],J=function F(G){G&&B(!0),c.W.get(P||"".concat(v.Z.apiPrefix,"subscriptions/").concat(Z.id,"/log")).then(function(X){var me=X.code,le=X.data;if(me===200&&localStorage.getItem("logSubscription")===String(Z.id)){var d=le;y(d||"\u6682\u65E0\u65E5\u5FD7"),Y(d&&!(0,x.x$)(d)),d&&!(0,x.x$)(d)&&setTimeout(function(){F()},2e3)}}).finally(function(){G&&B(!1)})},ce=function(){localStorage.removeItem("logSubscription"),xe()},de=function(){return(0,L.jsxs)(L.Fragment,{children:[(H||W)&&(0,L.jsx)(h.Z,{spin:!0}),!H&&!W&&(0,L.jsx)(j.Z,{}),(0,L.jsx)("span",{style:{marginLeft:5},children:Z&&Z.name})]})};return(0,f.useEffect)(function(){Z&&Z.id&&ae&&J(!0)},[Z,ae]),(0,f.useEffect)(function(){se&&y(se)},[se]),(0,f.useEffect)(function(){u(document.body.clientWidth<768)},[]),(0,L.jsx)(S.Z,{title:de(),open:ae,centered:!0,className:"log-modal",bodyStyle:{minHeight:"300px"},forceRender:!0,onOk:function(){return ce()},onCancel:function(){return ce()},footer:[(0,L.jsx)(r.Z,{type:"primary",onClick:function(){return ce()},children:"\u77E5\u9053\u4E86"})],children:W?(0,L.jsx)(he.Z,{}):(0,L.jsx)("pre",{style:ne?{fontFamily:"Source Code Pro",width:375,zoom:.83}:{},children:o})})};C.default=_},89634:function(p,C,e){"use strict";e.r(C);var i=e(35290),l=e.n(i),f=e(30279),m=e.n(f),S=e(411),r=e.n(S),c=e(46686),v=e.n(c),h=e(63313),j=e.n(h),he=e(83347),x=e(64664),L=e(15976),_=e(62021),De=e(39936),ee=e(4675),Z=e(22545),xe=e(28608),ae=e(19452),se=e(38041),P=e.n(se),t=e(11527),b=he.Z.Option,o=/[^\/\:]+\/[^\/]+(?=\.git)/,y=/[^\/\:]+\/[^\/]+$/,ue=function(W){var B=W.subscription,I=W.handleCancel,k=W.visible,H=x.Z.useForm(),Y=v()(H,1),M=Y[0],Q=(0,h.useState)(!1),ne=v()(Q,2),u=ne[0],J=ne[1],ce=(0,h.useState)("public-repo"),de=v()(ce,2),F=de[0],G=de[1],X=(0,h.useState)("crontab"),me=v()(X,2),le=me[0],d=me[1],Ee=(0,h.useState)("ssh-key"),Oe=v()(Ee,2),Pe=Oe[0],re=Oe[1],je=function(){var R=r()(l()().mark(function s(D){var E,K,N,ve,ie;return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return J(!0),E=B?"put":"post",K=m()({},D),B&&(K.id=B.id),z.prev=4,z.next=7,xe.W[E]("".concat(ae.Z.apiPrefix,"subscriptions"),{data:K});case 7:N=z.sent,ve=N.code,ie=N.data,ve===200&&(L.ZP.success(B?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),I(ie)),J(!1),z.next=17;break;case 14:z.prev=14,z.t0=z.catch(4),J(!1);case 17:case"end":return z.stop()}},s,null,[[4,14]])}));return function(D){return R.apply(this,arguments)}}(),be=function(s){G(s.target.value);var D=M.getFieldValue("url"),E=M.getFieldValue("branch");M.setFieldsValue({alias:Fe(D,E,s.target.value)}),D&&M.validateFields(["url"])},Se=function(s){d(s.target.value),M.setFieldsValue({schedule:""})},w=function(s){re(s.target.value)},$=function(s){var D=M.getFieldValue("branch");M.setFieldsValue({alias:Fe(s.target.value,D)})},pe=function(s){var D=M.getFieldValue("url");M.setFieldsValue({alias:Fe(D,s.target.value)})},Fe=function(s,D){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:F,K="",N=E==="file"?y:o;return N.test(s)&&(K=s.match(N)[0].replaceAll("/","_").replaceAll(".","_")),D&&(K=K+"_"+D),K},Ae=function(s){var D=s.value,E=s.onChange,K=(0,h.useState)("days"),N=v()(K,2),ve=N[0],ie=N[1],ye=(0,h.useState)(),z=v()(ye,2),Ce=z[0],ge=z[1],Be=function(fe){ie(fe),Ce&&Ce>0&&(E==null||E({type:fe,value:Ce}))},Te=function(fe){ge(fe),fe?E==null||E({type:ve,value:fe}):E==null||E(null)};return(0,h.useEffect)(function(){D&&(ie(D.type),ge(D.value))},[D]),(0,t.jsxs)(_.Z.Group,{compact:!0,children:[(0,t.jsx)(De.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:Ce,style:{width:"calc(100% - 58px)"},onChange:Te}),(0,t.jsxs)(he.Z,{value:ve,onChange:Be,children:[(0,t.jsx)(b,{value:"days",children:"\u5929"}),(0,t.jsx)(b,{value:"hours",children:"\u65F6"}),(0,t.jsx)(b,{value:"minutes",children:"\u5206"}),(0,t.jsx)(b,{value:"seconds",children:"\u79D2"})]})]})},Ze=function(s){var D=s.value,E=s.onChange,K=s.type;return K==="ssh-key"?(0,t.jsx)(x.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,t.jsx)(_.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,t.jsx)(x.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,t.jsx)(_.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},Me=(0,h.useCallback)(function(R){var s=R.clipboardData.getData("text");if(s.startsWith("ql ")){var D=s.split(" ").map(function(Be){return Be.trim().replace(/\"/g,"").replace(/\'/,"")}),E=v()(D,8),K=E[1],N=E[2],ve=E[3],ie=E[4],ye=E[5],z=E[6],Ce=E[7],ge=K==="raw"?"file":N.startsWith("http")?"public-repo":"private-repo";M.setFieldsValue({type:ge,url:N,whitelist:ve,blacklist:ie,dependences:ye,branch:z,extensions:Ce,alias:Fe(N,z)}),G(ge)}},[]),_e=(0,h.useCallback)(function(R){var s=R.clipboardData.getData("text");s.startsWith("ql ")&&R.preventDefault()},[]);return(0,h.useEffect)(function(){k?window.addEventListener("paste",Me):window.removeEventListener("paste",Me)},[k]),(0,h.useEffect)(function(){M.setFieldsValue(B||{}),G(B&&B.type||"public-repo"),d(B&&B.schedule_type||"crontab"),re(B&&B.pull_type||"ssh-key"),B||M.resetFields()},[B,k]),(0,t.jsx)(ee.Z,{title:B?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:k,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){M.validateFields().then(function(s){je(s)}).catch(function(s){console.log("Validate Failed:",s)})},onCancel:function(){return I()},confirmLoading:u,children:(0,t.jsxs)(x.Z,{form:M,name:"form_in_modal",layout:"vertical",children:[(0,t.jsx)(x.Z.Item,{name:"name",label:"\u540D\u79F0",children:(0,t.jsx)(_.Z,{placeholder:"\u652F\u6301\u62F7\u8D1Dql repo/raw\u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:_e})}),(0,t.jsx)(x.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,t.jsxs)(Z.ZP.Group,{onChange:be,children:[(0,t.jsx)(Z.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,t.jsx)(Z.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,t.jsx)(Z.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,t.jsx)(x.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:F==="file"?y:o}],children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:$,onChange:$})}),F!=="file"&&(0,t.jsx)(x.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,t.jsx)(_.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:pe,onChange:pe})}),(0,t.jsx)(x.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,t.jsx)(_.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),F==="private-repo"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,t.jsxs)(Z.ZP.Group,{onChange:w,children:[(0,t.jsx)(Z.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,t.jsx)(Z.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,t.jsx)(Ze,{type:Pe})]}),(0,t.jsx)(x.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,t.jsxs)(Z.ZP.Group,{onChange:Se,children:[(0,t.jsx)(Z.ZP,{value:"crontab",children:"crontab"}),(0,t.jsx)(Z.ZP,{value:"interval",children:"interval"})]})}),(0,t.jsx)(x.Z.Item,{name:le==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(s,D){return le==="interval"||!D||P().parseExpression(D).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:le==="interval"?(0,t.jsx)(Ae,{}):(0,t.jsx)(_.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),F!=="file"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(x.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(x.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(x.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,t.jsx)(_.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,t.jsx)(x.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,t.jsx)(x.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(_.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]})]})})};C.default=ue},37907:function(p,C,e){"use strict";e.d(C,{Z:function(){return se}});var i=e(76414),l=e(37579),f=e(54737),m=e(60382),S=e(84875),r=e.n(S),c=e(1334),v=e(63313),h=e(78809),j=e(1764),he=e(14466),x=function(P,t){var b={};for(var o in P)Object.prototype.hasOwnProperty.call(P,o)&&t.indexOf(o)<0&&(b[o]=P[o]);if(P!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,o=Object.getOwnPropertySymbols(P);y<o.length;y++)t.indexOf(o[y])<0&&Object.prototype.propertyIsEnumerable.call(P,o[y])&&(b[o[y]]=P[o[y]]);return b},L=function(t){var b,o=t.prefixCls,y=t.className,ue=t.checked,te=t.onChange,W=t.onClick,B=x(t,["prefixCls","className","checked","onChange","onClick"]),I=v.useContext(h.E_),k=I.getPrefixCls,H=function(ne){te==null||te(!ue),W==null||W(ne)},Y=k("tag",o),M=r()(Y,(b={},(0,i.Z)(b,"".concat(Y,"-checkable"),!0),(0,i.Z)(b,"".concat(Y,"-checkable-checked"),ue),b),y);return v.createElement("span",(0,l.Z)({},B,{className:M,onClick:H}))},_=L,De=function(P,t){var b={};for(var o in P)Object.prototype.hasOwnProperty.call(P,o)&&t.indexOf(o)<0&&(b[o]=P[o]);if(P!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,o=Object.getOwnPropertySymbols(P);y<o.length;y++)t.indexOf(o[y])<0&&Object.prototype.propertyIsEnumerable.call(P,o[y])&&(b[o[y]]=P[o[y]]);return b},ee=new RegExp("^(".concat(j.Y.join("|"),")(-inverse)?$")),Z=new RegExp("^(".concat(j.E.join("|"),")$")),xe=function(t,b){var o,y=t.prefixCls,ue=t.className,te=t.style,W=t.children,B=t.icon,I=t.color,k=t.onClose,H=t.closeIcon,Y=t.closable,M=Y===void 0?!1:Y,Q=De(t,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),ne=v.useContext(h.E_),u=ne.getPrefixCls,J=ne.direction,ce=v.useState(!0),de=(0,f.Z)(ce,2),F=de[0],G=de[1];v.useEffect(function(){"visible"in Q&&G(Q.visible)},[Q.visible]);var X=function(){return I?ee.test(I)||Z.test(I):!1},me=(0,l.Z)({backgroundColor:I&&!X()?I:void 0},te),le=X(),d=u("tag",y),Ee=r()(d,(o={},(0,i.Z)(o,"".concat(d,"-").concat(I),le),(0,i.Z)(o,"".concat(d,"-has-color"),I&&!le),(0,i.Z)(o,"".concat(d,"-hidden"),!F),(0,i.Z)(o,"".concat(d,"-rtl"),J==="rtl"),o),ue),Oe=function(pe){pe.stopPropagation(),k==null||k(pe),!pe.defaultPrevented&&("visible"in Q||G(!1))},Pe=function(){return M?H?v.createElement("span",{className:"".concat(d,"-close-icon"),onClick:Oe},H):v.createElement(m.Z,{className:"".concat(d,"-close-icon"),onClick:Oe}):null},re="onClick"in Q||W&&W.type==="a",je=(0,c.Z)(Q,["visible"]),be=B||null,Se=be?v.createElement(v.Fragment,null,be,v.createElement("span",null,W)):W,w=v.createElement("span",(0,l.Z)({},je,{ref:b,className:Ee,style:me}),Se,Pe());return re?v.createElement(he.Z,null,w):w},ae=v.forwardRef(xe);ae.CheckableTag=_;var se=ae},91394:function(){},13989:function(p,C,e){var i=e(33737);function l(f){if(Array.isArray(f))return i(f)}p.exports=l,p.exports.__esModule=!0,p.exports.default=p.exports},56037:function(p){function C(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}p.exports=C,p.exports.__esModule=!0,p.exports.default=p.exports},90623:function(p){function C(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}p.exports=C,p.exports.__esModule=!0,p.exports.default=p.exports},94434:function(p,C,e){var i=e(13989),l=e(56037),f=e(94945),m=e(90623);function S(r){return i(r)||l(r)||f(r)||m()}p.exports=S,p.exports.__esModule=!0,p.exports.default=p.exports}}]);
